2021-06-09 17:54:42.521 | INFO     | slp.util.log:configure_logging:84 - Log file will be saved in logs/mosei-rnn-m3-0.25-text-0.6.20210609-175442.log
2021-06-09 17:54:43.334 | INFO     | slp.plbind.dm:setup:159 - Using provided validation set
2021-06-09 17:54:43.334 | INFO     | slp.plbind.dm:setup:162 - Using provided test set
2021-06-09 17:54:43.335 | INFO     | slp.plbind.dm:setup:212 - Using 16327 samples for training
2021-06-09 17:54:43.335 | INFO     | slp.plbind.dm:setup:213 - Using 1871 samples for validation
2021-06-09 17:54:43.335 | INFO     | slp.plbind.dm:setup:216 - Using 4662 samples for testing
2021-06-09 17:54:43.355 | INFO     | slp.plbind.trainer:make_trainer:428 - Logs will be saved in rnn-m3-0.25-text-0.6/mosei-rnn-m3-0.25-text-0.6
2021-06-09 17:54:43.355 | INFO     | slp.plbind.trainer:make_trainer:429 - Logs will be saved in rnn-m3-0.25-text-0.6/mosei-rnn-m3-0.25-text-0.6/20210609-175443/checkpoints
2021-06-09 17:54:43.391 | INFO     | slp.plbind.trainer:make_trainer:461 - Configured wandb and CSV loggers.
2021-06-09 17:54:43.392 | INFO     | slp.plbind.trainer:make_trainer:462 - Wandb configured to run mosei-rnn-m3-0.25-text-0.6/20210609-175443 in project mosei-rnn-m3-0.25-text-0.6
2021-06-09 17:54:43.392 | INFO     | slp.plbind.trainer:make_trainer:467 - Results will be stored online.
2021-06-09 17:54:43.393 | INFO     | slp.plbind.trainer:make_trainer:475 - Experiment verbose description:
MOSEI RNN-baseline with M3 and higher text drop probability

Tags:['mosei', 'rnn-baseline', 'm3', 'regularization']
2021-06-09 17:54:43.396 | INFO     | slp.plbind.trainer:make_trainer:496 - Configured Early stopping and Model checkpointing to track val_loss
2021-06-09 17:54:43.434 | INFO     | pytorch_lightning.utilities.distributed:_info:54 - GPU available: True, used: True
2021-06-09 17:54:43.434 | INFO     | pytorch_lightning.utilities.distributed:_info:54 - TPU available: None, using: 0 TPU cores
2021-06-09 17:54:44.231 | INFO     | slp.plbind.trainer:watch_model:613 - Tracking model weights & gradients in wandb.
2021-06-09 17:54:44.232 | INFO     | pytorch_lightning.accelerators.gpu:set_nvidia_flags:40 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
2021-06-09 17:54:46.411 | INFO     | pytorch_lightning.core.lightning:summarize:1457 - 
  | Name          | Type                            | Params
------------------------------------------------------------------
0 | model         | AudioVisualTextMaskedClassifier | 1.6 M 
1 | criterion     | L1Loss                          | 0     
2 | train_metrics | ModuleDict                      | 0     
3 | val_metrics   | ModuleDict                      | 0     
4 | test_metrics  | ModuleDict                      | 0     
------------------------------------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.535     Total estimated model params size (MB)
2021-06-09 17:54:46.654 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Validation results
2021-06-09 17:54:46.655 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:54:46.656 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.4526515305042267
2021-06-09 17:54:46.657 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.359375       
2021-06-09 17:54:46.657 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.140625       
2021-06-09 17:54:46.658 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.09375        
2021-06-09 17:54:46.658 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.45771726965904236
2021-06-09 17:54:46.659 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.3530816435813904
2021-06-09 17:54:46.659 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         2.993631362915039
2021-06-09 17:54:46.660 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        2.993631362915039
2021-06-09 17:54:46.660 | INFO     | slp.plbind.module:log_to_console:484 - best_score      inf            
2021-06-09 17:54:46.661 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:55:22.062 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Training results
2021-06-09 17:55:22.062 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:55:22.063 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2      0.681227445602417
2021-06-09 17:55:22.065 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2_zero 0.6700271964073181
2021-06-09 17:55:22.073 | INFO     | slp.plbind.module:log_to_console:484 - train_acc5      0.37703555822372437
2021-06-09 17:55:22.074 | INFO     | slp.plbind.module:log_to_console:484 - train_acc7      0.3689631521701813
2021-06-09 17:55:22.075 | INFO     | slp.plbind.module:log_to_console:484 - train_f1        0.6583786010742188
2021-06-09 17:55:22.076 | INFO     | slp.plbind.module:log_to_console:484 - train_f1_zero   0.6568691730499268
2021-06-09 17:55:22.076 | INFO     | slp.plbind.module:log_to_console:484 - train_mae       1.2325266599655151
2021-06-09 17:55:22.077 | INFO     | slp.plbind.module:log_to_console:484 - train_loss      1.2325266599655151
2021-06-09 17:55:22.077 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:55:23.652 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Validation results
2021-06-09 17:55:23.654 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:55:23.657 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.7631489634513855
2021-06-09 17:55:23.659 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.7837570905685425
2021-06-09 17:55:23.661 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.40416666865348816
2021-06-09 17:55:23.663 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.3978107273578644
2021-06-09 17:55:23.664 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.7263963222503662
2021-06-09 17:55:23.666 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.7562204003334045
2021-06-09 17:55:23.668 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         0.7341756820678711
2021-06-09 17:55:23.669 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        0.7341756820678711
2021-06-09 17:55:23.671 | INFO     | slp.plbind.module:log_to_console:484 - best_score      inf            
2021-06-09 17:55:23.673 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:55:23.676 | INFO     | slp.plbind.helpers:_run_early_stopping_check:25 - Epoch 1 Early Stopping
2021-06-09 17:55:23.678 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:55:23.679 | INFO     | slp.plbind.helpers:_run_early_stopping_check:27 - best score      0.7341756820678711
2021-06-09 17:55:23.681 | INFO     | slp.plbind.helpers:_run_early_stopping_check:28 - patience left   10             
2021-06-09 17:55:23.682 | INFO     | slp.util.system:print_separator:81 - ##################################################
2021-06-09 17:55:59.062 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 2 Training results
2021-06-09 17:55:59.063 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:55:59.063 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2      0.7607014775276184
2021-06-09 17:55:59.064 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2_zero 0.7354364991188049
2021-06-09 17:55:59.065 | INFO     | slp.plbind.module:log_to_console:484 - train_acc5      0.44463762640953064
2021-06-09 17:55:59.065 | INFO     | slp.plbind.module:log_to_console:484 - train_acc7      0.43693214654922485
2021-06-09 17:55:59.066 | INFO     | slp.plbind.module:log_to_console:484 - train_f1        0.7529385089874268
2021-06-09 17:55:59.066 | INFO     | slp.plbind.module:log_to_console:484 - train_f1_zero   0.7353734970092773
2021-06-09 17:55:59.067 | INFO     | slp.plbind.module:log_to_console:484 - train_mae       0.7235060930252075
2021-06-09 17:55:59.067 | INFO     | slp.plbind.module:log_to_console:484 - train_loss      0.7235060930252075
2021-06-09 17:55:59.068 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:56:00.743 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 2 Validation results
2021-06-09 17:56:00.745 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:56:00.746 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.7861034870147705
2021-06-09 17:56:00.749 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.7566736936569214
2021-06-09 17:56:00.751 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.5154660940170288
2021-06-09 17:56:00.753 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.5054025650024414
2021-06-09 17:56:00.755 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.788054883480072
2021-06-09 17:56:00.756 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.7688867449760437
2021-06-09 17:56:00.757 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         0.624980628490448
2021-06-09 17:56:00.757 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        0.624980628490448
2021-06-09 17:56:00.758 | INFO     | slp.plbind.module:log_to_console:484 - best_score      0.7341756224632263
2021-06-09 17:56:00.759 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:56:00.761 | INFO     | slp.plbind.helpers:_run_early_stopping_check:25 - Epoch 2 Early Stopping
2021-06-09 17:56:00.762 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:56:00.763 | INFO     | slp.plbind.helpers:_run_early_stopping_check:27 - best score      0.624980628490448
2021-06-09 17:56:00.764 | INFO     | slp.plbind.helpers:_run_early_stopping_check:28 - patience left   10             
2021-06-09 17:56:00.765 | INFO     | slp.util.system:print_separator:81 - ##################################################
2021-06-09 17:56:00.861 | INFO     | pytorch_lightning.profiler.profilers:describe:96 - 

Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  77.423         	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  37.072         	|2              	|  74.145         	|  95.766         	|
run_training_batch                 	|  0.066938       	|1022           	|  68.41          	|  88.36          	|
optimizer_step_and_closure_0       	|  0.064407       	|1022           	|  65.824         	|  85.019         	|
training_step_and_backward         	|  0.053916       	|1022           	|  55.103         	|  71.171         	|
model_backward                     	|  0.027277       	|1022           	|  27.877         	|  36.007         	|
model_forward                      	|  0.026385       	|1022           	|  26.966         	|  34.83          	|
training_step                      	|  0.026125       	|1022           	|  26.7           	|  34.486         	|
evaluation_step_and_end            	|  0.02312        	|120            	|  2.7744         	|  3.5834         	|
validation_step                    	|  0.022978       	|120            	|  2.7574         	|  3.5615         	|
get_train_batch                    	|  0.00048012     	|1022           	|  0.49068        	|  0.63377        	|
on_train_batch_end                 	|  0.00015559     	|1022           	|  0.15902        	|  0.20539        	|
on_train_batch_start               	|  0.00012247     	|1022           	|  0.12517        	|  0.16167        	|
cache_result                       	|  1.9943e-05     	|5501           	|  0.1097         	|  0.1417         	|
on_validation_end                  	|  0.03456        	|3              	|  0.10368        	|  0.13391        	|
on_train_end                       	|  0.0441         	|1              	|  0.0441         	|  0.05696        	|
on_batch_start                     	|  2.869e-05      	|1022           	|  0.029321       	|  0.037871       	|
on_before_zero_grad                	|  2.8517e-05     	|1022           	|  0.029144       	|  0.037643       	|
on_after_backward                  	|  2.8044e-05     	|1022           	|  0.028661       	|  0.037018       	|
on_batch_end                       	|  2.0363e-05     	|1022           	|  0.020811       	|  0.026879       	|
on_validation_batch_end            	|  9.7284e-05     	|120            	|  0.011674       	|  0.015078       	|
training_step_end                  	|  1.0341e-05     	|1022           	|  0.010568       	|  0.01365        	|
on_train_start                     	|  0.0025693      	|1              	|  0.0025693      	|  0.0033185      	|
on_validation_batch_start          	|  1.686e-05      	|120            	|  0.0020232      	|  0.0026132      	|
validation_step_end                	|  1.1054e-05     	|120            	|  0.0013265      	|  0.0017133      	|
on_validation_start                	|  0.00036826     	|3              	|  0.0011048      	|  0.001427       	|
on_epoch_start                     	|  0.00053029     	|2              	|  0.0010606      	|  0.0013698      	|
on_validation_epoch_end            	|  2.1858e-05     	|3              	|  6.5574e-05     	|  8.4697e-05     	|
on_epoch_end                       	|  1.2031e-05     	|5              	|  6.0157e-05     	|  7.77e-05       	|
on_train_epoch_end                 	|  2.0862e-05     	|2              	|  4.1724e-05     	|  5.3892e-05     	|
on_validation_epoch_start          	|  1.1814e-05     	|3              	|  3.5442e-05     	|  4.5777e-05     	|
on_train_epoch_start               	|  1.3423e-05     	|2              	|  2.6846e-05     	|  3.4674e-05     	|
on_fit_start                       	|  2.4195e-05     	|1              	|  2.4195e-05     	|  3.1251e-05     	|
on_before_accelerator_backend_setup	|  1.0014e-05     	|1              	|  1.0014e-05     	|  1.2934e-05     	|

