2021-06-09 17:43:39.908 | INFO     | slp.util.log:configure_logging:84 - Log file will be saved in logs/m3-rnn-hard-0.2-before.20210609-174339.log
2021-06-09 17:43:40.727 | INFO     | slp.plbind.dm:setup:159 - Using provided validation set
2021-06-09 17:43:40.728 | INFO     | slp.plbind.dm:setup:162 - Using provided test set
2021-06-09 17:43:40.728 | INFO     | slp.plbind.dm:setup:212 - Using 16327 samples for training
2021-06-09 17:43:40.728 | INFO     | slp.plbind.dm:setup:213 - Using 1871 samples for validation
2021-06-09 17:43:40.728 | INFO     | slp.plbind.dm:setup:216 - Using 4662 samples for testing
2021-06-09 17:43:40.748 | INFO     | slp.plbind.trainer:make_trainer:428 - Logs will be saved in rnn-m3-0.2/m3-rnn-hard-0.2-before
2021-06-09 17:43:40.748 | INFO     | slp.plbind.trainer:make_trainer:429 - Logs will be saved in rnn-m3-0.2/m3-rnn-hard-0.2-before/20210609-174340/checkpoints
2021-06-09 17:43:40.792 | INFO     | slp.plbind.trainer:make_trainer:461 - Configured wandb and CSV loggers.
2021-06-09 17:43:40.793 | INFO     | slp.plbind.trainer:make_trainer:462 - Wandb configured to run m3-rnn-hard-0.2-before/20210609-174340 in project m3-rnn-hard-0.2-before
2021-06-09 17:43:40.794 | INFO     | slp.plbind.trainer:make_trainer:467 - Results will be stored online.
2021-06-09 17:43:40.794 | INFO     | slp.plbind.trainer:make_trainer:475 - Experiment verbose description:
MOSEI RNN-baseline with M3

Tags:['mosei', 'rnn-baseline', 'm3', 'regularization']
2021-06-09 17:43:40.797 | INFO     | slp.plbind.trainer:make_trainer:496 - Configured Early stopping and Model checkpointing to track val_loss
2021-06-09 17:43:40.835 | INFO     | pytorch_lightning.utilities.distributed:_info:54 - GPU available: True, used: True
2021-06-09 17:43:40.836 | INFO     | pytorch_lightning.utilities.distributed:_info:54 - TPU available: None, using: 0 TPU cores
2021-06-09 17:43:41.623 | INFO     | slp.plbind.trainer:watch_model:613 - Tracking model weights & gradients in wandb.
2021-06-09 17:43:41.625 | INFO     | pytorch_lightning.accelerators.gpu:set_nvidia_flags:40 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
2021-06-09 17:43:43.793 | INFO     | pytorch_lightning.core.lightning:summarize:1457 - 
  | Name          | Type                            | Params
------------------------------------------------------------------
0 | model         | AudioVisualTextMaskedClassifier | 1.6 M 
1 | criterion     | L1Loss                          | 0     
2 | train_metrics | ModuleDict                      | 0     
3 | val_metrics   | ModuleDict                      | 0     
4 | test_metrics  | ModuleDict                      | 0     
------------------------------------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.535     Total estimated model params size (MB)
2021-06-09 17:43:44.041 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Validation results
2021-06-09 17:43:44.043 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:43:44.044 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.43939393758773804
2021-06-09 17:43:44.044 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.59375        
2021-06-09 17:43:44.045 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.0625         
2021-06-09 17:43:44.045 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.046875       
2021-06-09 17:43:44.046 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.3640918731689453
2021-06-09 17:43:44.046 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.5133856534957886
2021-06-09 17:43:44.047 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         2.5588555335998535
2021-06-09 17:43:44.047 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        2.5588555335998535
2021-06-09 17:43:44.048 | INFO     | slp.plbind.module:log_to_console:484 - best_score      inf            
2021-06-09 17:43:44.048 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:44:18.948 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Training results
2021-06-09 17:44:18.949 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:44:18.954 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2      0.6802271008491516
2021-06-09 17:44:18.955 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2_zero 0.6631255149841309
2021-06-09 17:44:18.957 | INFO     | slp.plbind.module:log_to_console:484 - train_acc5      0.38041654229164124
2021-06-09 17:44:18.958 | INFO     | slp.plbind.module:log_to_console:484 - train_acc7      0.3747291564941406
2021-06-09 17:44:18.960 | INFO     | slp.plbind.module:log_to_console:484 - train_f1        0.6602411866188049
2021-06-09 17:44:18.961 | INFO     | slp.plbind.module:log_to_console:484 - train_f1_zero   0.6526864171028137
2021-06-09 17:44:18.963 | INFO     | slp.plbind.module:log_to_console:484 - train_mae       0.9918943643569946
2021-06-09 17:44:18.964 | INFO     | slp.plbind.module:log_to_console:484 - train_loss      0.9918943643569946
2021-06-09 17:44:18.966 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:44:20.637 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Validation results
2021-06-09 17:44:20.639 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:44:20.641 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.7666401267051697
2021-06-09 17:44:20.643 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.7412429451942444
2021-06-09 17:44:20.645 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.4820268154144287
2021-06-09 17:44:20.647 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.48043784499168396
2021-06-09 17:44:20.649 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.7534078359603882
2021-06-09 17:44:20.651 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.7388595938682556
2021-06-09 17:44:20.653 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         0.6544954776763916
2021-06-09 17:44:20.654 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        0.6544954776763916
2021-06-09 17:44:20.656 | INFO     | slp.plbind.module:log_to_console:484 - best_score      inf            
2021-06-09 17:44:20.658 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:44:20.661 | INFO     | slp.plbind.helpers:_run_early_stopping_check:25 - Epoch 1 Early Stopping
2021-06-09 17:44:20.663 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:44:20.664 | INFO     | slp.plbind.helpers:_run_early_stopping_check:27 - best score      0.6544954776763916
2021-06-09 17:44:20.665 | INFO     | slp.plbind.helpers:_run_early_stopping_check:28 - patience left   10             
2021-06-09 17:44:20.667 | INFO     | slp.util.system:print_separator:81 - ##################################################
2021-06-09 17:44:56.240 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 2 Training results
2021-06-09 17:44:56.240 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:44:56.241 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2      0.7737924456596375
2021-06-09 17:44:56.242 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2_zero 0.7459812164306641
2021-06-09 17:44:56.242 | INFO     | slp.plbind.module:log_to_console:484 - train_acc5      0.4656573235988617
2021-06-09 17:44:56.243 | INFO     | slp.plbind.module:log_to_console:484 - train_acc7      0.4573403000831604
2021-06-09 17:44:56.243 | INFO     | slp.plbind.module:log_to_console:484 - train_f1        0.7694830298423767
2021-06-09 17:44:56.244 | INFO     | slp.plbind.module:log_to_console:484 - train_f1_zero   0.7500736713409424
2021-06-09 17:44:56.244 | INFO     | slp.plbind.module:log_to_console:484 - train_mae       0.6898163557052612
2021-06-09 17:44:56.245 | INFO     | slp.plbind.module:log_to_console:484 - train_loss      0.6898163557052612
2021-06-09 17:44:56.245 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:44:57.879 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 2 Validation results
2021-06-09 17:44:57.882 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:44:57.884 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.7863497734069824
2021-06-09 17:44:57.886 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.787994384765625
2021-06-09 17:44:57.888 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.47838982939720154
2021-06-09 17:44:57.890 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.4709745943546295
2021-06-09 17:44:57.892 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.7713432908058167
2021-06-09 17:44:57.893 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.7828038334846497
2021-06-09 17:44:57.895 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         0.6369485855102539
2021-06-09 17:44:57.897 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        0.6369485855102539
2021-06-09 17:44:57.898 | INFO     | slp.plbind.module:log_to_console:484 - best_score      0.6544954776763916
2021-06-09 17:44:57.899 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:44:57.903 | INFO     | slp.plbind.helpers:_run_early_stopping_check:25 - Epoch 2 Early Stopping
2021-06-09 17:44:57.904 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:44:57.905 | INFO     | slp.plbind.helpers:_run_early_stopping_check:27 - best score      0.6369485855102539
2021-06-09 17:44:57.907 | INFO     | slp.plbind.helpers:_run_early_stopping_check:28 - patience left   10             
2021-06-09 17:44:57.908 | INFO     | slp.util.system:print_separator:81 - ##################################################
2021-06-09 17:44:58.019 | INFO     | pytorch_lightning.profiler.profilers:describe:96 - 

Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  77.174         	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  36.954         	|2              	|  73.907         	|  95.767         	|
run_training_batch                 	|  0.066662       	|1022           	|  68.128         	|  88.278         	|
optimizer_step_and_closure_0       	|  0.064086       	|1022           	|  65.495         	|  84.867         	|
training_step_and_backward         	|  0.053743       	|1022           	|  54.925         	|  71.17          	|
model_backward                     	|  0.027233       	|1022           	|  27.832         	|  36.064         	|
model_forward                      	|  0.026249       	|1022           	|  26.827         	|  34.761         	|
training_step                      	|  0.025986       	|1022           	|  26.558         	|  34.413         	|
evaluation_step_and_end            	|  0.023147       	|120            	|  2.7777         	|  3.5992         	|
validation_step                    	|  0.023018       	|120            	|  2.7622         	|  3.5792         	|
get_train_batch                    	|  0.00046379     	|1022           	|  0.474          	|  0.61419        	|
on_train_batch_end                 	|  0.00015561     	|1022           	|  0.15903        	|  0.20607        	|
on_train_batch_start               	|  0.00012421     	|1022           	|  0.12694        	|  0.16449        	|
on_validation_end                  	|  0.037968       	|3              	|  0.1139         	|  0.14759        	|
cache_result                       	|  1.9594e-05     	|5501           	|  0.10779        	|  0.13967        	|
on_train_end                       	|  0.046757       	|1              	|  0.046757       	|  0.060587       	|
on_before_zero_grad                	|  3.0963e-05     	|1022           	|  0.031644       	|  0.041003       	|
on_after_backward                  	|  2.9105e-05     	|1022           	|  0.029745       	|  0.038543       	|
on_batch_start                     	|  2.8771e-05     	|1022           	|  0.029404       	|  0.038101       	|
on_batch_end                       	|  2.1293e-05     	|1022           	|  0.021761       	|  0.028198       	|
training_step_end                  	|  1.0312e-05     	|1022           	|  0.010539       	|  0.013656       	|
on_validation_batch_end            	|  8.2192e-05     	|120            	|  0.009863       	|  0.01278        	|
on_train_start                     	|  0.0025643      	|1              	|  0.0025643      	|  0.0033227      	|
on_validation_batch_start          	|  1.5586e-05     	|120            	|  0.0018703      	|  0.0024235      	|
validation_step_end                	|  9.761e-06      	|120            	|  0.0011713      	|  0.0015178      	|
on_validation_start                	|  0.00036651     	|3              	|  0.0010995      	|  0.0014247      	|
on_epoch_start                     	|  0.00046572     	|2              	|  0.00093144     	|  0.0012069      	|
on_validation_epoch_end            	|  2.5806e-05     	|3              	|  7.7418e-05     	|  0.00010032     	|
on_epoch_end                       	|  1.2286e-05     	|5              	|  6.1432e-05     	|  7.9601e-05     	|
on_train_epoch_end                 	|  2.306e-05      	|2              	|  4.612e-05      	|  5.9761e-05     	|
on_validation_epoch_start          	|  1.2646e-05     	|3              	|  3.7938e-05     	|  4.9159e-05     	|
on_train_epoch_start               	|  1.5946e-05     	|2              	|  3.1892e-05     	|  4.1324e-05     	|
on_fit_start                       	|  2.3491e-05     	|1              	|  2.3491e-05     	|  3.0439e-05     	|
on_before_accelerator_backend_setup	|  2.2384e-05     	|1              	|  2.2384e-05     	|  2.9004e-05     	|

