2021-06-09 17:56:42.330 | INFO     | slp.util.log:configure_logging:84 - Log file will be saved in logs/mosei-rnn-m3-0.25-text-0.6.20210609-175642.log
2021-06-09 17:56:43.150 | INFO     | slp.plbind.dm:setup:159 - Using provided validation set
2021-06-09 17:56:43.151 | INFO     | slp.plbind.dm:setup:162 - Using provided test set
2021-06-09 17:56:43.151 | INFO     | slp.plbind.dm:setup:212 - Using 16327 samples for training
2021-06-09 17:56:43.151 | INFO     | slp.plbind.dm:setup:213 - Using 1871 samples for validation
2021-06-09 17:56:43.151 | INFO     | slp.plbind.dm:setup:216 - Using 4662 samples for testing
2021-06-09 17:56:43.171 | INFO     | slp.plbind.trainer:make_trainer:428 - Logs will be saved in rnn-m3-0.25-text-0.6/mosei-rnn-m3-0.25-text-0.6
2021-06-09 17:56:43.171 | INFO     | slp.plbind.trainer:make_trainer:429 - Logs will be saved in rnn-m3-0.25-text-0.6/mosei-rnn-m3-0.25-text-0.6/20210609-175643/checkpoints
2021-06-09 17:56:43.207 | INFO     | slp.plbind.trainer:make_trainer:461 - Configured wandb and CSV loggers.
2021-06-09 17:56:43.207 | INFO     | slp.plbind.trainer:make_trainer:462 - Wandb configured to run mosei-rnn-m3-0.25-text-0.6/20210609-175643 in project mosei-rnn-m3-0.25-text-0.6
2021-06-09 17:56:43.208 | INFO     | slp.plbind.trainer:make_trainer:467 - Results will be stored online.
2021-06-09 17:56:43.209 | INFO     | slp.plbind.trainer:make_trainer:475 - Experiment verbose description:
MOSEI RNN-baseline with M3 and higher text drop probability

Tags:['mosei', 'rnn-baseline', 'm3', 'regularization']
2021-06-09 17:56:43.211 | INFO     | slp.plbind.trainer:make_trainer:496 - Configured Early stopping and Model checkpointing to track val_loss
2021-06-09 17:56:43.251 | INFO     | pytorch_lightning.utilities.distributed:_info:54 - GPU available: True, used: True
2021-06-09 17:56:43.251 | INFO     | pytorch_lightning.utilities.distributed:_info:54 - TPU available: None, using: 0 TPU cores
2021-06-09 17:56:44.059 | INFO     | slp.plbind.trainer:watch_model:613 - Tracking model weights & gradients in wandb.
2021-06-09 17:56:44.060 | INFO     | pytorch_lightning.accelerators.gpu:set_nvidia_flags:40 - LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [3]
2021-06-09 17:56:46.207 | INFO     | pytorch_lightning.core.lightning:summarize:1457 - 
  | Name          | Type                            | Params
------------------------------------------------------------------
0 | model         | AudioVisualTextMaskedClassifier | 1.6 M 
1 | criterion     | L1Loss                          | 0     
2 | train_metrics | ModuleDict                      | 0     
3 | val_metrics   | ModuleDict                      | 0     
4 | test_metrics  | ModuleDict                      | 0     
------------------------------------------------------------------
1.6 M     Trainable params
0         Non-trainable params
1.6 M     Total params
6.535     Total estimated model params size (MB)
2021-06-09 17:56:46.451 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Validation results
2021-06-09 17:56:46.451 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:56:46.452 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.5719696879386902
2021-06-09 17:56:46.453 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.609375       
2021-06-09 17:56:46.453 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.1875         
2021-06-09 17:56:46.454 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.15625        
2021-06-09 17:56:46.454 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.571969747543335
2021-06-09 17:56:46.455 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.6072793006896973
2021-06-09 17:56:46.455 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         1.7727441787719727
2021-06-09 17:56:46.456 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        1.7727441787719727
2021-06-09 17:56:46.456 | INFO     | slp.plbind.module:log_to_console:484 - best_score      inf            
2021-06-09 17:56:46.457 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:57:21.618 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Training results
2021-06-09 17:57:21.618 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:57:21.619 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2      0.6907620429992676
2021-06-09 17:57:21.620 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2_zero 0.674377977848053
2021-06-09 17:57:21.620 | INFO     | slp.plbind.module:log_to_console:484 - train_acc5      0.38733574748039246
2021-06-09 17:57:21.621 | INFO     | slp.plbind.module:log_to_console:484 - train_acc7      0.38140377402305603
2021-06-09 17:57:21.621 | INFO     | slp.plbind.module:log_to_console:484 - train_f1        0.6688928604125977
2021-06-09 17:57:21.622 | INFO     | slp.plbind.module:log_to_console:484 - train_f1_zero   0.6636739373207092
2021-06-09 17:57:21.622 | INFO     | slp.plbind.module:log_to_console:484 - train_mae       1.04091477394104
2021-06-09 17:57:21.623 | INFO     | slp.plbind.module:log_to_console:484 - train_loss      1.04091477394104
2021-06-09 17:57:21.623 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:57:23.249 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 1 Validation results
2021-06-09 17:57:23.251 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:57:23.252 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.7568171620368958
2021-06-09 17:57:23.254 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.7195974588394165
2021-06-09 17:57:23.255 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.4825564920902252
2021-06-09 17:57:23.255 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.4788488745689392
2021-06-09 17:57:23.256 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.7552139163017273
2021-06-09 17:57:23.257 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.7259389758110046
2021-06-09 17:57:23.258 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         0.6574568152427673
2021-06-09 17:57:23.259 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        0.6574568152427673
2021-06-09 17:57:23.260 | INFO     | slp.plbind.module:log_to_console:484 - best_score      inf            
2021-06-09 17:57:23.261 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:57:23.264 | INFO     | slp.plbind.helpers:_run_early_stopping_check:25 - Epoch 1 Early Stopping
2021-06-09 17:57:23.264 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:57:23.265 | INFO     | slp.plbind.helpers:_run_early_stopping_check:27 - best score      0.6574568152427673
2021-06-09 17:57:23.266 | INFO     | slp.plbind.helpers:_run_early_stopping_check:28 - patience left   10             
2021-06-09 17:57:23.267 | INFO     | slp.util.system:print_separator:81 - ##################################################
2021-06-09 17:57:58.802 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 2 Training results
2021-06-09 17:57:58.802 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:57:58.803 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2      0.7649955749511719
2021-06-09 17:57:58.804 | INFO     | slp.plbind.module:log_to_console:484 - train_acc2_zero 0.7406695485115051
2021-06-09 17:57:58.804 | INFO     | slp.plbind.module:log_to_console:484 - train_acc5      0.4507618248462677
2021-06-09 17:57:58.805 | INFO     | slp.plbind.module:log_to_console:484 - train_acc7      0.44336211681365967
2021-06-09 17:57:58.805 | INFO     | slp.plbind.module:log_to_console:484 - train_f1        0.754200279712677
2021-06-09 17:57:58.806 | INFO     | slp.plbind.module:log_to_console:484 - train_f1_zero   0.737612247467041
2021-06-09 17:57:58.806 | INFO     | slp.plbind.module:log_to_console:484 - train_mae       0.7188608646392822
2021-06-09 17:57:58.807 | INFO     | slp.plbind.module:log_to_console:484 - train_loss      0.7188608646392822
2021-06-09 17:57:58.808 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:58:00.485 | INFO     | slp.plbind.module:log_to_console:478 - Epoch 2 Validation results
2021-06-09 17:58:00.487 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:58:00.490 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2        0.7460957169532776
2021-06-09 17:58:00.492 | INFO     | slp.plbind.module:log_to_console:484 - val_acc2_zero   0.6865465641021729
2021-06-09 17:58:00.494 | INFO     | slp.plbind.module:log_to_console:484 - val_acc5        0.4901130199432373
2021-06-09 17:58:00.496 | INFO     | slp.plbind.module:log_to_console:484 - val_acc7        0.4826977550983429
2021-06-09 17:58:00.498 | INFO     | slp.plbind.module:log_to_console:484 - val_f1          0.7491018176078796
2021-06-09 17:58:00.500 | INFO     | slp.plbind.module:log_to_console:484 - val_f1_zero     0.6999777555465698
2021-06-09 17:58:00.502 | INFO     | slp.plbind.module:log_to_console:484 - val_mae         0.6589271426200867
2021-06-09 17:58:00.504 | INFO     | slp.plbind.module:log_to_console:484 - val_loss        0.6589271426200867
2021-06-09 17:58:00.505 | INFO     | slp.plbind.module:log_to_console:484 - best_score      0.6574567556381226
2021-06-09 17:58:00.507 | INFO     | slp.util.system:print_separator:81 - %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
2021-06-09 17:58:00.511 | INFO     | slp.plbind.helpers:_run_early_stopping_check:25 - Epoch 2 Early Stopping
2021-06-09 17:58:00.513 | INFO     | slp.util.system:print_separator:81 - --------------------------------------------------
2021-06-09 17:58:00.514 | INFO     | slp.plbind.helpers:_run_early_stopping_check:27 - best score      0.6574568152427673
2021-06-09 17:58:00.516 | INFO     | slp.plbind.helpers:_run_early_stopping_check:28 - patience left   9              
2021-06-09 17:58:00.517 | INFO     | slp.util.system:print_separator:81 - ##################################################
2021-06-09 17:58:00.584 | INFO     | pytorch_lightning.profiler.profilers:describe:96 - 

Profiler Report

Action                             	|  Mean duration (s)	|Num calls      	|  Total time (s) 	|  Percentage %   	|
------------------------------------------------------------------------------------------------------------------------------------
Total                              	|  -              	|_              	|  77.326         	|  100 %          	|
------------------------------------------------------------------------------------------------------------------------------------
run_training_epoch                 	|  37.032         	|2              	|  74.064         	|  95.781         	|
run_training_batch                 	|  0.066968       	|1022           	|  68.441         	|  88.51          	|
optimizer_step_and_closure_0       	|  0.064439       	|1022           	|  65.857         	|  85.167         	|
training_step_and_backward         	|  0.054213       	|1022           	|  55.406         	|  71.652         	|
model_backward                     	|  0.027477       	|1022           	|  28.082         	|  36.316         	|
model_forward                      	|  0.02649        	|1022           	|  27.073         	|  35.011         	|
training_step                      	|  0.026233       	|1022           	|  26.81          	|  34.671         	|
evaluation_step_and_end            	|  0.02312        	|120            	|  2.7744         	|  3.5879         	|
validation_step                    	|  0.022987       	|120            	|  2.7584         	|  3.5673         	|
get_train_batch                    	|  0.00041831     	|1022           	|  0.42752        	|  0.55287        	|
on_train_batch_end                 	|  0.00015572     	|1022           	|  0.15914        	|  0.2058         	|
on_train_batch_start               	|  0.00012397     	|1022           	|  0.12669        	|  0.16384        	|
cache_result                       	|  1.9197e-05     	|5501           	|  0.1056         	|  0.13657        	|
on_validation_end                  	|  0.020511       	|3              	|  0.061534       	|  0.079577       	|
on_train_end                       	|  0.048649       	|1              	|  0.048649       	|  0.062914       	|
on_before_zero_grad                	|  3.0758e-05     	|1022           	|  0.031435       	|  0.040652       	|
on_batch_start                     	|  2.7403e-05     	|1022           	|  0.028006       	|  0.036218       	|
on_after_backward                  	|  2.6626e-05     	|1022           	|  0.027212       	|  0.035191       	|
on_batch_end                       	|  1.9264e-05     	|1022           	|  0.019688       	|  0.025461       	|
on_validation_batch_end            	|  9.1972e-05     	|120            	|  0.011037       	|  0.014273       	|
training_step_end                  	|  9.3736e-06     	|1022           	|  0.0095799      	|  0.012389       	|
on_train_start                     	|  0.0025983      	|1              	|  0.0025983      	|  0.0033602      	|
on_validation_batch_start          	|  1.7013e-05     	|120            	|  0.0020416      	|  0.0026402      	|
validation_step_end                	|  1.1402e-05     	|120            	|  0.0013682      	|  0.0017694      	|
on_validation_start                	|  0.00039054     	|3              	|  0.0011716      	|  0.0015152      	|
on_epoch_start                     	|  0.00049346     	|2              	|  0.00098692     	|  0.0012763      	|
on_validation_epoch_end            	|  2.4234e-05     	|3              	|  7.2702e-05     	|  9.4019e-05     	|
on_epoch_end                       	|  1.1656e-05     	|5              	|  5.8282e-05     	|  7.5372e-05     	|
on_train_epoch_end                 	|  2.0054e-05     	|2              	|  4.0108e-05     	|  5.1869e-05     	|
on_validation_epoch_start          	|  1.152e-05      	|3              	|  3.456e-05      	|  4.4693e-05     	|
on_train_epoch_start               	|  1.3124e-05     	|2              	|  2.6248e-05     	|  3.3945e-05     	|
on_fit_start                       	|  2.2388e-05     	|1              	|  2.2388e-05     	|  2.8952e-05     	|
on_before_accelerator_backend_setup	|  7.706e-06      	|1              	|  7.706e-06      	|  9.9655e-06     	|

